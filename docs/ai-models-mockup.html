<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Alexandria Platform - AI Models Management</title>
  <link href="https://cdnjs.cloudflare.com/ajax/libs/tailwindcss/2.2.19/tailwind.min.css" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.7.0/chart.min.js"></script>
  <style>
    :root {
      --color-primary: #3b82f6;
      --color-primary-dark: #2563eb;
      --color-secondary: #6366f1;
      --color-success: #10b981;
      --color-warning: #f59e0b;
      --color-danger: #ef4444;
      --color-bg-dark: #0d0d0d;
      --color-surface-dark: #171717;
      --color-card-dark: #1a1a1a;
      --color-border-dark: #262626;
      --color-border-light: #333333;
      --color-ollama: #00A67E;
      --color-openai: #74AA9C;
      --color-anthropic: #D97757;
      --color-azure: #0078D4;
    }

    * {
      box-sizing: border-box;
    }

    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'SF Pro Display', 'Inter', sans-serif;
      background-color: var(--color-bg-dark);
      color: #e5e5e5;
      margin: 0;
      padding: 0;
      font-size: 13px;
      -webkit-font-smoothing: antialiased;
    }

    /* Scrollbar */
    ::-webkit-scrollbar {
      width: 10px;
      height: 10px;
    }

    ::-webkit-scrollbar-track {
      background: transparent;
    }

    ::-webkit-scrollbar-thumb {
      background: rgba(255, 255, 255, 0.1);
      border-radius: 5px;
    }

    ::-webkit-scrollbar-thumb:hover {
      background: rgba(255, 255, 255, 0.2);
    }

    /* Main Layout */
    .app-container {
      display: flex;
      flex-direction: column;
      height: 100vh;
    }

    .header {
      background-color: var(--color-surface-dark);
      border-bottom: 1px solid var(--color-border-dark);
      padding: 16px 24px;
      display: flex;
      align-items: center;
      justify-content: space-between;
    }

    .header-title {
      font-size: 20px;
      font-weight: 600;
      display: flex;
      align-items: center;
      gap: 12px;
    }

    .header-actions {
      display: flex;
      gap: 12px;
    }

    .content-container {
      flex: 1;
      overflow-y: auto;
      padding: 24px;
    }

    /* Stats Cards */
    .stats-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
      gap: 16px;
      margin-bottom: 32px;
    }

    .stat-card {
      background-color: var(--color-card-dark);
      border: 1px solid var(--color-border-dark);
      border-radius: 8px;
      padding: 20px;
      transition: all 0.2s ease;
    }

    .stat-card:hover {
      border-color: var(--color-primary);
      transform: translateY(-2px);
    }

    .stat-icon {
      width: 48px;
      height: 48px;
      border-radius: 8px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 24px;
      margin-bottom: 12px;
    }

    .stat-value {
      font-size: 32px;
      font-weight: 700;
      color: #ffffff;
      margin-bottom: 4px;
    }

    .stat-label {
      font-size: 13px;
      color: #8b8b8b;
    }

    /* Tabs */
    .tabs-container {
      display: flex;
      gap: 4px;
      margin-bottom: 24px;
      border-bottom: 1px solid var(--color-border-dark);
    }

    .tab {
      padding: 12px 24px;
      cursor: pointer;
      color: #8b8b8b;
      transition: all 0.15s ease;
      position: relative;
      font-weight: 500;
    }

    .tab:hover {
      color: #e5e5e5;
    }

    .tab.active {
      color: #ffffff;
    }

    .tab.active::after {
      content: '';
      position: absolute;
      bottom: -1px;
      left: 0;
      right: 0;
      height: 2px;
      background-color: var(--color-primary);
    }

    /* Model Cards */
    .models-grid {
      display: grid;
      gap: 20px;
    }

    .model-card {
      background-color: var(--color-card-dark);
      border: 1px solid var(--color-border-dark);
      border-radius: 8px;
      overflow: hidden;
      transition: all 0.2s ease;
    }

    .model-card:hover {
      border-color: var(--color-border-light);
    }

    .model-header {
      background-color: var(--color-surface-dark);
      padding: 20px;
      display: flex;
      align-items: center;
      gap: 16px;
    }

    .model-icon {
      width: 56px;
      height: 56px;
      border-radius: 8px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 28px;
      flex-shrink: 0;
    }

    .model-info {
      flex: 1;
    }

    .model-name {
      font-size: 18px;
      font-weight: 600;
      color: #ffffff;
      margin-bottom: 4px;
    }

    .model-id {
      font-size: 12px;
      color: #8b8b8b;
      font-family: monospace;
    }

    .model-status {
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .status-badge {
      display: inline-flex;
      align-items: center;
      gap: 6px;
      padding: 4px 12px;
      border-radius: 16px;
      font-size: 11px;
      font-weight: 500;
    }

    .status-badge.active {
      background-color: rgba(16, 185, 129, 0.1);
      color: #10b981;
    }

    .status-badge.inactive {
      background-color: rgba(107, 114, 128, 0.1);
      color: #6b7280;
    }

    .model-body {
      padding: 20px;
    }

    .config-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 20px;
      margin-bottom: 20px;
    }

    .config-item {
      display: flex;
      flex-direction: column;
      gap: 8px;
    }

    .config-label {
      font-size: 11px;
      color: #8b8b8b;
      text-transform: uppercase;
      letter-spacing: 0.05em;
    }

    .config-value {
      font-size: 14px;
      color: #e5e5e5;
      font-weight: 500;
    }

    .capabilities {
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
      margin-bottom: 20px;
    }

    .capability-badge {
      display: inline-flex;
      align-items: center;
      gap: 6px;
      padding: 6px 12px;
      background-color: rgba(99, 102, 241, 0.1);
      color: #818cf8;
      border-radius: 6px;
      font-size: 12px;
      font-weight: 500;
    }

    .model-actions {
      display: flex;
      gap: 12px;
      padding-top: 20px;
      border-top: 1px solid var(--color-border-dark);
    }

    /* Buttons */
    .btn {
      display: inline-flex;
      align-items: center;
      gap: 8px;
      padding: 8px 16px;
      font-size: 13px;
      font-weight: 500;
      border-radius: 6px;
      cursor: pointer;
      transition: all 0.15s ease;
      border: none;
      outline: none;
      user-select: none;
    }

    .btn-primary {
      background-color: var(--color-primary);
      color: white;
    }

    .btn-primary:hover {
      background-color: var(--color-primary-dark);
    }

    .btn-secondary {
      background-color: rgba(255, 255, 255, 0.08);
      color: #e5e5e5;
      border: 1px solid var(--color-border-light);
    }

    .btn-secondary:hover {
      background-color: rgba(255, 255, 255, 0.12);
      border-color: #4a4a4a;
    }

    .btn-danger {
      background-color: rgba(239, 68, 68, 0.1);
      color: #ef4444;
      border: 1px solid rgba(239, 68, 68, 0.2);
    }

    .btn-danger:hover {
      background-color: rgba(239, 68, 68, 0.2);
    }

    /* Progress Bar */
    .progress-container {
      margin-top: 12px;
    }

    .progress-bar {
      height: 4px;
      background-color: rgba(255, 255, 255, 0.1);
      border-radius: 2px;
      overflow: hidden;
    }

    .progress-fill {
      height: 100%;
      background-color: var(--color-primary);
      transition: width 0.3s ease;
    }

    /* Configuration Panel */
    .config-panel {
      background-color: var(--color-surface-dark);
      border: 1px solid var(--color-border-dark);
      border-radius: 8px;
      padding: 24px;
      margin-top: 24px;
    }

    .config-title {
      font-size: 16px;
      font-weight: 600;
      margin-bottom: 20px;
      display: flex;
      align-items: center;
      gap: 12px;
    }

    .form-group {
      margin-bottom: 16px;
    }

    .form-label {
      display: block;
      font-size: 12px;
      color: #8b8b8b;
      margin-bottom: 6px;
      font-weight: 500;
    }

    .form-input {
      width: 100%;
      background-color: rgba(255, 255, 255, 0.05);
      border: 1px solid var(--color-border-dark);
      border-radius: 4px;
      padding: 8px 12px;
      color: #e5e5e5;
      font-size: 13px;
      outline: none;
      transition: all 0.15s ease;
    }

    .form-input:focus {
      border-color: var(--color-primary);
      background-color: rgba(255, 255, 255, 0.08);
    }

    .form-select {
      appearance: none;
      background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 20 20'%3E%3Cpath stroke='%236b7280' stroke-linecap='round' stroke-linejoin='round' stroke-width='1.5' d='M6 8l4 4 4-4'/%3E%3C/svg%3E");
      background-position: right 0.5rem center;
      background-repeat: no-repeat;
      background-size: 1.5em 1.5em;
      padding-right: 2.5rem;
    }

    /* Loading State */
    .loading-container {
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      padding: 60px;
      color: #8b8b8b;
    }

    .loading-spinner {
      width: 48px;
      height: 48px;
      border: 3px solid rgba(255, 255, 255, 0.1);
      border-top-color: var(--color-primary);
      border-radius: 50%;
      animation: spin 1s linear infinite;
      margin-bottom: 16px;
    }

    @keyframes spin {
      to { transform: rotate(360deg); }
    }

    /* Empty State */
    .empty-state {
      text-align: center;
      padding: 60px;
      color: #8b8b8b;
    }

    .empty-icon {
      font-size: 48px;
      margin-bottom: 16px;
      opacity: 0.5;
    }

    .empty-title {
      font-size: 18px;
      font-weight: 600;
      color: #e5e5e5;
      margin-bottom: 8px;
    }

    .empty-description {
      font-size: 14px;
      margin-bottom: 24px;
    }

    /* Animations */
    .fade-in {
      animation: fadeIn 0.3s ease-out;
    }

    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(10px); }
      to { opacity: 1; transform: translateY(0); }
    }

    /* Responsive */
    @media (max-width: 768px) {
      .content-container {
        padding: 16px;
      }

      .stats-grid {
        grid-template-columns: 1fr 1fr;
      }

      .config-grid {
        grid-template-columns: 1fr;
      }

      .model-actions {
        flex-direction: column;
      }

      .btn {
        width: 100%;
        justify-content: center;
      }
    }
  </style>
</head>
<body>
  <div class="app-container">
    <!-- Header -->
    <div class="header">
      <div class="header-title">
        <i class="fa-solid fa-brain" style="color: var(--color-secondary);"></i>
        AI Models Management
      </div>
      <div class="header-actions">
        <button class="btn btn-secondary" onclick="refreshModels()">
          <i class="fa-solid fa-arrows-rotate"></i>
          Refresh
        </button>
        <button class="btn btn-primary" onclick="showAddProviderModal()">
          <i class="fa-solid fa-plus"></i>
          Add Provider
        </button>
      </div>
    </div>

    <!-- Content -->
    <div class="content-container">
      <!-- Stats -->
      <div class="stats-grid">
        <div class="stat-card fade-in">
          <div class="stat-icon" style="background-color: rgba(59, 130, 246, 0.1); color: var(--color-primary);">
            <i class="fa-solid fa-layer-group"></i>
          </div>
          <div class="stat-value" id="totalModelsCount">0</div>
          <div class="stat-label">Total Models</div>
        </div>
        <div class="stat-card fade-in" style="animation-delay: 0.05s;">
          <div class="stat-icon" style="background-color: rgba(16, 185, 129, 0.1); color: var(--color-success);">
            <i class="fa-solid fa-circle-check"></i>
          </div>
          <div class="stat-value" id="activeModelsCount">0</div>
          <div class="stat-label">Active Models</div>
        </div>
        <div class="stat-card fade-in" style="animation-delay: 0.1s;">
          <div class="stat-icon" style="background-color: rgba(0, 166, 126, 0.1); color: var(--color-ollama);">
            <i class="fa-solid fa-server"></i>
          </div>
          <div class="stat-value" id="ollamaModelsCount">0</div>
          <div class="stat-label">Ollama Models</div>
        </div>
        <div class="stat-card fade-in" style="animation-delay: 0.15s;">
          <div class="stat-icon" style="background-color: rgba(116, 170, 156, 0.1); color: var(--color-openai);">
            <i class="fa-solid fa-cloud"></i>
          </div>
          <div class="stat-value" id="apiModelsCount">0</div>
          <div class="stat-label">API Models</div>
        </div>
      </div>

      <!-- Tabs -->
      <div class="tabs-container">
        <div class="tab active" onclick="switchTab('all')">
          <i class="fa-solid fa-grid-2"></i>
          All Models
        </div>
        <div class="tab" onclick="switchTab('ollama')">
          <i class="fa-solid fa-server"></i>
          Ollama Models
        </div>
        <div class="tab" onclick="switchTab('api')">
          <i class="fa-solid fa-cloud"></i>
          API Models
        </div>
        <div class="tab" onclick="switchTab('providers')">
          <i class="fa-solid fa-plug"></i>
          Providers
        </div>
      </div>

      <!-- Models Container -->
      <div id="modelsContainer" class="models-grid">
        <!-- Loading State -->
        <div class="loading-container">
          <div class="loading-spinner"></div>
          <div>Loading models...</div>
        </div>
      </div>

      <!-- Configuration Panel (hidden by default) -->
      <div id="configPanel" class="config-panel" style="display: none;">
        <div class="config-title">
          <i class="fa-solid fa-gear"></i>
          Model Configuration
        </div>
        <!-- Config form will be inserted here -->
      </div>
    </div>
  </div>

  <script>
    // Configuration
    const OLLAMA_HOST = 'http://localhost:11434';
    let currentTab = 'all';
    let allModels = [];
    let providers = [];

    // Initialize
    document.addEventListener('DOMContentLoaded', () => {
      loadModels();
      setInterval(loadModels, 30000); // Refresh every 30 seconds
    });

    // Load models from Ollama and configuration
    async function loadModels() {
      try {
        // Load Ollama models
        const ollamaModels = await loadOllamaModels();
        
        // Load configured API models (mock data for demo)
        const apiModels = loadAPIModels();
        
        // Combine all models
        allModels = [...ollamaModels, ...apiModels];
        
        // Update stats
        updateStats();
        
        // Render models
        renderModels();
      } catch (error) {
        console.error('Failed to load models:', error);
        showError();
      }
    }

    // Load Ollama models
    async function loadOllamaModels() {
      try {
        const response = await fetch(`${OLLAMA_HOST}/api/tags`);
        if (!response.ok) throw new Error('Ollama not available');
        
        const data = await response.json();
        return (data.models || []).map(model => ({
          id: `ollama:${model.name}`,
          name: model.name,
          provider: 'ollama',
          type: 'local',
          status: 'active',
          size: formatBytes(model.size),
          family: model.details?.family || 'unknown',
          parameterSize: model.details?.parameter_size || 'unknown',
          quantization: model.details?.quantization_level || 'unknown',
          capabilities: detectCapabilities(model.name),
          config: {
            contextLength: inferContextLength(model.name),
            temperature: 0.7,
            maxTokens: 2048,
            topP: 0.9,
            topK: 40,
            repeatPenalty: 1.1
          }
        }));
      } catch (error) {
        console.warn('Failed to load Ollama models:', error);
        return [];
      }
    }

    // Load API models (mock data for demonstration)
    function loadAPIModels() {
      return [
        {
          id: 'openai:gpt-4',
          name: 'GPT-4',
          provider: 'openai',
          type: 'api',
          status: 'inactive',
          capabilities: ['chat', 'code', 'function_calling'],
          config: {
            contextLength: 8192,
            temperature: 0.7,
            maxTokens: 4096,
            cost: { input: 0.03, output: 0.06 }
          }
        },
        {
          id: 'anthropic:claude-3-opus',
          name: 'Claude 3 Opus',
          provider: 'anthropic',
          type: 'api',
          status: 'inactive',
          capabilities: ['chat', 'code', 'vision'],
          config: {
            contextLength: 200000,
            temperature: 0.7,
            maxTokens: 4096,
            cost: { input: 0.015, output: 0.075 }
          }
        }
      ];
    }

    // Detect model capabilities
    function detectCapabilities(modelName) {
      const capabilities = [];
      const name = modelName.toLowerCase();
      
      if (name.includes('chat') || name.includes('llama') || name.includes('mistral')) {
        capabilities.push('chat');
      }
      if (name.includes('code')) {
        capabilities.push('code');
      }
      if (name.includes('embed')) {
        capabilities.push('embeddings');
      }
      if (name.includes('vision') || name.includes('llava')) {
        capabilities.push('vision');
      }
      if (name.includes('instruct')) {
        capabilities.push('instruct');
      }
      
      return capabilities.length > 0 ? capabilities : ['chat'];
    }

    // Infer context length
    function inferContextLength(modelName) {
      const name = modelName.toLowerCase();
      if (name.includes('32k')) return 32768;
      if (name.includes('16k')) return 16384;
      if (name.includes('8k')) return 8192;
      if (name.includes('4k')) return 4096;
      return 4096;
    }

    // Format bytes
    function formatBytes(bytes) {
      const units = ['B', 'KB', 'MB', 'GB'];
      let size = bytes;
      let unitIndex = 0;
      
      while (size >= 1024 && unitIndex < units.length - 1) {
        size /= 1024;
        unitIndex++;
      }
      
      return `${size.toFixed(1)} ${units[unitIndex]}`;
    }

    // Update statistics
    function updateStats() {
      const totalModels = allModels.length;
      const activeModels = allModels.filter(m => m.status === 'active').length;
      const ollamaModels = allModels.filter(m => m.provider === 'ollama').length;
      const apiModels = allModels.filter(m => m.type === 'api').length;
      
      document.getElementById('totalModelsCount').textContent = totalModels;
      document.getElementById('activeModelsCount').textContent = activeModels;
      document.getElementById('ollamaModelsCount').textContent = ollamaModels;
      document.getElementById('apiModelsCount').textContent = apiModels;
    }

    // Render models based on current tab
    function renderModels() {
      const container = document.getElementById('modelsContainer');
      let modelsToShow = allModels;
      
      // Filter based on tab
      if (currentTab === 'ollama') {
        modelsToShow = allModels.filter(m => m.provider === 'ollama');
      } else if (currentTab === 'api') {
        modelsToShow = allModels.filter(m => m.type === 'api');
      } else if (currentTab === 'providers') {
        renderProviders();
        return;
      }
      
      if (modelsToShow.length === 0) {
        container.innerHTML = `
          <div class="empty-state">
            <div class="empty-icon">
              <i class="fa-solid fa-brain"></i>
            </div>
            <div class="empty-title">No Models Found</div>
            <div class="empty-description">
              ${currentTab === 'ollama' ? 'Install Ollama models using: ollama pull llama2' : 'Configure API providers to use cloud models'}
            </div>
            <button class="btn btn-primary" onclick="${currentTab === 'ollama' ? 'showOllamaGuide()' : 'showAddProviderModal()'}">
              <i class="fa-solid fa-plus"></i>
              ${currentTab === 'ollama' ? 'Install Models' : 'Add Provider'}
            </button>
          </div>
        `;
        return;
      }
      
      container.innerHTML = modelsToShow.map(model => `
        <div class="model-card fade-in">
          <div class="model-header">
            <div class="model-icon" style="background-color: ${getProviderColor(model.provider, 0.1)}; color: ${getProviderColor(model.provider)};">
              <i class="fa-solid ${getProviderIcon(model.provider)}"></i>
            </div>
            <div class="model-info">
              <div class="model-name">${model.name}</div>
              <div class="model-id">${model.id}</div>
            </div>
            <div class="model-status">
              <div class="status-badge ${model.status}">
                <i class="fa-solid fa-circle" style="font-size: 8px;"></i>
                ${model.status === 'active' ? 'Active' : 'Inactive'}
              </div>
            </div>
          </div>
          <div class="model-body">
            <!-- Capabilities -->
            <div class="capabilities">
              ${model.capabilities.map(cap => `
                <div class="capability-badge">
                  <i class="fa-solid ${getCapabilityIcon(cap)}"></i>
                  ${cap}
                </div>
              `).join('')}
            </div>
            
            <!-- Configuration -->
            <div class="config-grid">
              ${model.provider === 'ollama' ? `
                <div class="config-item">
                  <div class="config-label">Size</div>
                  <div class="config-value">${model.size}</div>
                </div>
                <div class="config-item">
                  <div class="config-label">Family</div>
                  <div class="config-value">${model.family}</div>
                </div>
                <div class="config-item">
                  <div class="config-label">Parameters</div>
                  <div class="config-value">${model.parameterSize}</div>
                </div>
                <div class="config-item">
                  <div class="config-label">Quantization</div>
                  <div class="config-value">${model.quantization}</div>
                </div>
              ` : ''}
              <div class="config-item">
                <div class="config-label">Context Length</div>
                <div class="config-value">${model.config.contextLength.toLocaleString()} tokens</div>
              </div>
              <div class="config-item">
                <div class="config-label">Temperature</div>
                <div class="config-value">${model.config.temperature}</div>
              </div>
              <div class="config-item">
                <div class="config-label">Max Tokens</div>
                <div class="config-value">${model.config.maxTokens.toLocaleString()}</div>
              </div>
              ${model.config.cost ? `
                <div class="config-item">
                  <div class="config-label">Cost (per 1K tokens)</div>
                  <div class="config-value">
                    In: $${model.config.cost.input} / Out: $${model.config.cost.output}
                  </div>
                </div>
              ` : ''}
            </div>
            
            <!-- Actions -->
            <div class="model-actions">
              ${model.status === 'active' ? `
                <button class="btn btn-primary" onclick="testModel('${model.id}')">
                  <i class="fa-solid fa-play"></i>
                  Test Model
                </button>
                <button class="btn btn-secondary" onclick="showModelConfig('${model.id}')">
                  <i class="fa-solid fa-gear"></i>
                  Configure
                </button>
              ` : `
                <button class="btn btn-primary" onclick="activateModel('${model.id}')">
                  <i class="fa-solid fa-power-off"></i>
                  Activate
                </button>
              `}
              ${model.provider === 'ollama' ? `
                <button class="btn btn-danger" onclick="unloadModel('${model.id}')">
                  <i class="fa-solid fa-trash"></i>
                  Unload
                </button>
              ` : ''}
            </div>
          </div>
        </div>
      `).join('');
    }

    // Get provider color
    function getProviderColor(provider, opacity = 1) {
      const colors = {
        ollama: 'var(--color-ollama)',
        openai: 'var(--color-openai)',
        anthropic: 'var(--color-anthropic)',
        azure: 'var(--color-azure)'
      };
      const color = colors[provider] || 'var(--color-primary)';
      return opacity < 1 ? color.replace(')', `, ${opacity})`) : color;
    }

    // Get provider icon
    function getProviderIcon(provider) {
      const icons = {
        ollama: 'fa-server',
        openai: 'fa-robot',
        anthropic: 'fa-user-astronaut',
        azure: 'fa-microsoft'
      };
      return icons[provider] || 'fa-brain';
    }

    // Get capability icon
    function getCapabilityIcon(capability) {
      const icons = {
        chat: 'fa-comments',
        code: 'fa-code',
        embeddings: 'fa-vector-square',
        vision: 'fa-eye',
        instruct: 'fa-graduation-cap',
        function_calling: 'fa-function'
      };
      return icons[capability] || 'fa-circle';
    }

    // Switch tab
    function switchTab(tab) {
      currentTab = tab;
      
      // Update tab UI
      document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
      event.target.classList.add('active');
      
      // Render content
      renderModels();
    }

    // Render providers view
    function renderProviders() {
      const container = document.getElementById('modelsContainer');
      
      // Mock providers data
      const providers = [
        {
          id: 'ollama',
          name: 'Ollama (Local)',
          status: 'connected',
          endpoint: OLLAMA_HOST,
          models: allModels.filter(m => m.provider === 'ollama').length
        },
        {
          id: 'openai',
          name: 'OpenAI',
          status: 'not_configured',
          endpoint: 'https://api.openai.com/v1',
          models: 2
        },
        {
          id: 'anthropic',
          name: 'Anthropic',
          status: 'not_configured',
          endpoint: 'https://api.anthropic.com/v1',
          models: 2
        }
      ];
      
      container.innerHTML = `
        <div class="config-panel">
          <div class="config-title">
            <i class="fa-solid fa-plug"></i>
            AI Providers Configuration
          </div>
          ${providers.map(provider => `
            <div class="model-card" style="margin-bottom: 16px;">
              <div class="model-header">
                <div class="model-icon" style="background-color: ${getProviderColor(provider.id, 0.1)}; color: ${getProviderColor(provider.id)};">
                  <i class="fa-solid ${getProviderIcon(provider.id)}"></i>
                </div>
                <div class="model-info">
                  <div class="model-name">${provider.name}</div>
                  <div class="model-id">${provider.endpoint}</div>
                </div>
                <div class="model-status">
                  <div class="status-badge ${provider.status === 'connected' ? 'active' : 'inactive'}">
                    <i class="fa-solid fa-circle" style="font-size: 8px;"></i>
                    ${provider.status === 'connected' ? 'Connected' : 'Not Configured'}
                  </div>
                </div>
              </div>
              <div class="model-body">
                <div class="config-grid">
                  <div class="config-item">
                    <div class="config-label">Available Models</div>
                    <div class="config-value">${provider.models}</div>
                  </div>
                  ${provider.id !== 'ollama' ? `
                    <div class="config-item">
                      <div class="config-label">API Key</div>
                      <div class="config-value">${provider.status === 'connected' ? '••••••••' : 'Not Set'}</div>
                    </div>
                  ` : ''}
                </div>
                <div class="model-actions">
                  ${provider.id === 'ollama' ? `
                    <button class="btn btn-secondary" onclick="testOllamaConnection()">
                      <i class="fa-solid fa-plug"></i>
                      Test Connection
                    </button>
                  ` : `
                    <button class="btn btn-primary" onclick="configureProvider('${provider.id}')">
                      <i class="fa-solid fa-gear"></i>
                      Configure
                    </button>
                  `}
                </div>
              </div>
            </div>
          `).join('')}
        </div>
      `;
    }

    // Test model
    async function testModel(modelId) {
      const model = allModels.find(m => m.id === modelId);
      if (!model) return;
      
      // Show testing state
      alert(`Testing ${model.name}...\n\nThis would send a test prompt to the model and display the response.`);
    }

    // Show model configuration
    function showModelConfig(modelId) {
      const model = allModels.find(m => m.id === modelId);
      if (!model) return;
      
      const configPanel = document.getElementById('configPanel');
      configPanel.style.display = 'block';
      configPanel.innerHTML = `
        <div class="config-title">
          <i class="fa-solid fa-gear"></i>
          Configure ${model.name}
        </div>
        <div class="form-group">
          <label class="form-label">Temperature</label>
          <input type="range" class="form-input" min="0" max="2" step="0.1" value="${model.config.temperature}" />
          <div style="display: flex; justify-content: space-between; font-size: 11px; color: #8b8b8b; margin-top: 4px;">
            <span>Creative</span>
            <span>${model.config.temperature}</span>
            <span>Focused</span>
          </div>
        </div>
        <div class="form-group">
          <label class="form-label">Max Tokens</label>
          <input type="number" class="form-input" value="${model.config.maxTokens}" />
        </div>
        <div class="form-group">
          <label class="form-label">Default Model</label>
          <select class="form-input form-select">
            <option>No</option>
            <option>Yes</option>
          </select>
        </div>
        <div style="display: flex; gap: 12px; margin-top: 24px;">
          <button class="btn btn-primary" onclick="saveModelConfig('${modelId}')">
            <i class="fa-solid fa-save"></i>
            Save Configuration
          </button>
          <button class="btn btn-secondary" onclick="document.getElementById('configPanel').style.display = 'none'">
            Cancel
          </button>
        </div>
      `;
      
      // Scroll to config panel
      configPanel.scrollIntoView({ behavior: 'smooth' });
    }

    // Refresh models
    function refreshModels() {
      loadModels();
    }

    // Show error state
    function showError() {
      const container = document.getElementById('modelsContainer');
      container.innerHTML = `
        <div class="empty-state">
          <div class="empty-icon" style="color: var(--color-danger);">
            <i class="fa-solid fa-exclamation-triangle"></i>
          </div>
          <div class="empty-title">Connection Error</div>
          <div class="empty-description">
            Failed to connect to Ollama. Make sure Ollama is running on ${OLLAMA_HOST}
          </div>
          <button class="btn btn-primary" onclick="refreshModels()">
            <i class="fa-solid fa-arrows-rotate"></i>
            Retry
          </button>
        </div>
      `;
    }

    // Placeholder functions
    function showAddProviderModal() {
      alert('Add Provider Modal - Would show form to configure API providers');
    }

    function showOllamaGuide() {
      alert('Ollama Installation Guide:\n\n1. Install Ollama from https://ollama.ai\n2. Run: ollama pull llama2\n3. Run: ollama pull mistral\n4. Refresh this page');
    }

    function activateModel(modelId) {
      alert(`Activating model: ${modelId}`);
    }

    function unloadModel(modelId) {
      if (confirm(`Unload model ${modelId}?`)) {
        alert(`Model ${modelId} unloaded`);
      }
    }

    function testOllamaConnection() {
      alert(`Testing connection to ${OLLAMA_HOST}...`);
    }

    function configureProvider(providerId) {
      alert(`Configure ${providerId} provider - Would show API key configuration form`);
    }

    function saveModelConfig(modelId) {
      alert(`Configuration saved for ${modelId}`);
      document.getElementById('configPanel').style.display = 'none';
    }
  </script>
</body>
</html>
